\documentclass[10pt,dvipsnames]{beamer}

%\usepackage{pgfpages}
%\mode<handout>{\setbeamercolor{background canvas}{bg=black!20}}
%\pgfpagesuselayout{4 on 1}[letterpaper,border shrink=5mm]

\usepackage{lmodern}
\usepackage{xcolor}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amsfonts}
\usepackage{verbatim}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing}
\beamertemplatenavigationsymbolsempty
\setbeamertemplate{footline}[frame number]
\addtolength{\oddsidemargin}{-3pt}

\definecolor{dgreen}{rgb}{0.,0.6,0.}
\definecolor{highlight}{rgb}{0.,0.6,0.}

\usepackage{multimedia}

\title{Cancer classification based on miRNA profiles using ASP} 
\author{K. Becker and H. Klarner}
\date{Berlin, Mai 2016}
\institute{
Freie Universit√§t Berlin, Germany
}
% logo of my university
\titlegraphic{\vfill\includegraphics[width=2cm]{FU-Logo}\hspace*{4.75cm}~%
   \includegraphics[width=2cm]{BMBF-Logo}
}

\begin{document}


\frame{\titlepage}


%{\tiny R. Thomas. "Regulatory networks seen as asynchronous automata." JTB, 1991}


\begin{frame}{Selective cell targeting}
\large
\begin{itemize}
\item \textbf{Problem:} Discrimination of tumor from healthy tissues
\end{itemize}
\vspace{0.5cm}
\begin{center}
\includegraphics[scale=0.3]{cells1.png}
\end{center}
\vspace{0.5cm}
\begin{itemize}
\item \textbf{Idea:} Cells differ in miRNA profiles
\end{itemize}
\end{frame}


\begin{frame}{In vitro classification - Biochemical circuits}
\begin{itemize}
\item synthesized in laboratory
\end{itemize}
\end{frame}

\begin{frame}{A boolean expression in conjunctive normal form (CNF)}
\begin{itemize}
\item conjunction (AND) of \emph{gates}
\item each gate is a disjunction (OR) of literals
\item \textbf{example:}  
\begin{align*}
(a + b + !c) * (d + e) * (!f)
\end{align*}
{\small $+$ means disjunction, $*$ means conjunction, $!$ means negation}
\vspace{0.2cm}
\item CNF evaluates to 1 (\emph{predicts cancer}) iff every gate evaluates to 1
\end{itemize}
\vspace{0.2cm}
\begin{center}
\includegraphics[scale=0.25]{classifier_exp.png}
\end{center}
\end{frame}


\begin{frame}{Constraints from biology}
\begin{itemize}
 \item less than 10 inputs in total
 \item no more than 6 inputs attached to the AND gate
 \item no more than 3 inputs atttached to any OR gate
 \item no NOT gates attached to an OR gate
 \item {\color{orange} no more than 2 OR gates}
 \item no more than 4 NOT gates
\end{itemize}
\begin{center}
\includegraphics[scale=0.3]{classifier_max.png}
\end{center}
\end{frame}


\begin{frame}{Our encoding in ASP - Reminder}
  \begin{itemize}
  \item facts:
 \end{itemize}
 \begin{center}
  \texttt{ P(A). }
 \end{center}
 
 \vspace{0.5cm} 
   \begin{itemize}
  \item conditional constraints:
 \end{itemize}
 \begin{center}
  \texttt{ Q(A) :- P(A). }
 \end{center}

  \vspace{0.5cm} 
  \begin{itemize}
  \item count constraints:
 \end{itemize}
 \begin{center}
  \texttt{ X \{ Q(A,B) \} Y. }
 \end{center}

 \vspace{0.5cm} 
 \begin{itemize}
  \item conditional count constraints:
 \end{itemize}
 \begin{center}
  \texttt{ X \{ Q(A,B) \} Y :- P(A). }
 \end{center}

  \vspace{0.5cm} 
  \begin{itemize}
  \item integrity constraints:
 \end{itemize}
  \begin{center}
  \texttt{ :- P(A). }
 \end{center}
\end{frame}


\begin{frame}[fragile]{Input: Data}
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
ID&	Annots&	g1&	g2&	g3\\
\hline
1&	0&	1&	1&	0\\
2&	0&	0&	0&	1\\
3&	1&	0&	1&	0\\
\hline
\end{tabular}
\begin{tikzpicture}[overlay]
\draw[decorate, decoration={brace}]
      (-2.2,1.2) -- node[above=0.15cm, scale=1] {\textbf{miRNAs}} (-0.2,1.2);
\draw[decorate, decoration={brace}]
      (-3.8,1.2) -- node[above=0.15cm, scale=1] {\textbf{cancer?}} (-2.5,1.2);
\draw[decorate, decoration={brace}]
      (-5,-0.7) -- node[left=0.15cm, scale=1] {\textbf{tissues}} (-5,0.5);
\end{tikzpicture}
\end{center}
\vspace{0.2cm}
\begin{verbatim}
tissue(1,healthy). tissue(2,healthy). tissue(3,cancer).
 
data(1,g1,high). data(1,g2,high). data(1,g3,low).
data(2,g1,low).  data(2,g2,low).  data(2,g3,high).
data(3,g1,low).  data(3,g2,high). data(3,g3,low).
 
is_mirna(Y) :- data(X,Y,Z).
\end{verbatim}
\end{frame}



\begin{frame}[fragile]{Input: Classifier structure}
\begin{center}
\includegraphics[scale=0.25]{classifier.png}
\end{center}
\vspace{0.3cm}

\begin{verbatim}
is_gate_type(type1).

upper_bound_pos_inputs(type1, 1). 
upper_bound_neg_inputs(type1, 0). 
lower_bound_pos_inputs(type1, 0). 
lower_bound_neg_inputs(type1, 0). 
upper_bound_gate_occurence(type1, 1). 
 
upper_bound_inputs(2).
\end{verbatim}

%\begin{tikzpicture}[overlay]
%\draw[decorate, decoration={brace}]
%      (6,3.35) -- node[right=0.15cm, scale=1] {\textbf{bounds for gate type 1}} (6,1.35);
%\end{tikzpicture}
\end{frame}


\begin{frame}[fragile]{Decision 1: How many gates do we use?}
\small
\begin{verbatim}
1 {number_of_gates(1..2)} 1.

is_integer(1..2).
is_gate_id(GateID) :- number_of_gates(X),is_integer(GateID), 
                      GateID<=X.
\end{verbatim}
\end{frame}


\begin{frame}[fragile]{Decision 2: What is the gate type of each gate?}
\small
\begin{verbatim}
1 {gate_type(GateID, X) : is_gate_type(X)} 1 :- is_gate_id(GateID).
\end{verbatim}
\end{frame}


\begin{frame}[fragile]{Decision 3: What are the inputs for our gates?}
\small
{\color{blue}{\large positive inputs:}}
\begin{verbatim}
X {gate_input(GateID,positive,MiRNA):is_mirna(MiRNA)} Y 
   :-is_gate_id(GateID),gate_type(GateID,GateType),
     lower_bound_pos_inputs(GateType,X), 
     upper_bound_pos_inputs(GateType,Y).
\end{verbatim}

{\color{blue}{\large negative inputs:}}
\begin{verbatim}
X {gate_input(GateID,negative,MiRNA):is_mirna(MiRNA)} Y 
   :-is_gate_id(GateID),gate_type(GateID,GateType),
     lower_bound_neg_inputs(GateType,X),
     upper_bound_neg_inputs(GateType,Y).
\end{verbatim}
\end{frame}



\begin{frame}[fragile]{Constraints}
 \begin{itemize}
  \item count constraints
  \item conditional count constraints
 \end{itemize}
 \vspace{1cm}
 \begin{center}
  \texttt{ X \{ Q(A,B) \} Y {\color{orange} :- P(A)}. }
 \end{center}


\end{frame}


\begin{frame}{Gates must have inputs}
 \texttt{
 1 \{gate\_input(GateID, Sign, MiRNA):\\
  \quad {\color{gray} is\_sign(Sign), is\_mirna(MiRNA)}\} :- is\_gate\_id(GateID).
 }
\end{frame}


\begin{frame}{Inputs must be unique}
 \texttt{
  \{gate\_input(GateID,Sign,MiRNA):\\
   \quad {\color{gray} is\_sign(Sign), is\_gate(GateID)}\} 1 :- is\_mirna(MiRNA).
 }
\end{frame}


\begin{frame}{Number of inputs is bounded}
 \texttt{
  \{gate\_input(GateID,Sign,MiRNA):\\
   \quad {\color{gray} is\_gate\_id(GateID), is\_sign(Sign), is\_mirna(MiRNA)}\} X :-\\
   \quad upper\_bound\_inputs(X).
 }
\end{frame}

\begin{frame}{Occurences of gates}
 \texttt{
  \{gate\_type(GateID,GateType):{\color{gray}\;is\_gate\_id(GateID)}\} X :-\\
     \quad is\_gate\_type(GateType),\\
     \quad upper\_bound\_gate\_occurence(GateType,X).
 }
\end{frame}
 

\begin{frame}{Activity of gates}
 \texttt{
 gate\_fires(GateID,TissueID) :-\\
   \quad gate\_input(GateID,{\color{orange} positive},MiRNA),\\
   \quad data(TissueID,MiRNA,{\color{orange} high}).\\
 }
 \vspace{1cm}
 \texttt{
 gate\_fires(GateID,TissueID) :-\\
   \quad gate\_input(GateID,{\color{orange} negative},MiRNA),\\
   \quad data(TissueID,MiRNA,{\color{orange} low}).
 }
\end{frame}

\begin{frame}{The classifier}
 \texttt{
  classifier(TissueID, healthy) :-\\
    \quad not gate\_fires(GateID, TissueID),\\
    \quad is\_gate\_id(GateID), is\_tissue\_id(TissueID).\\
 }
 \vspace{1cm}
 \texttt{
  classifier(TissueID, cancer) :-\\
    \quad not classifier(TissueID, healthy),\\
    \quad is\_tissue\_id(TissueID).
 }
\end{frame}



\begin{frame}{Optimization}
 \begin{itemize}
  \item single objective
  \item with priorities
  \item weighted sum
 \end{itemize}
\end{frame}

\begin{frame}[fragile]{Single Objective}
 \begin{verbatim}
  #minimize{ 1,GateID:gate_input(GateID,Sign,MiRNA) }.
 \end{verbatim}
\end{frame}

\begin{frame}[fragile]{Priorities}
 \begin{verbatim}
  #minimize{ 1@1,GateID:gate_input(GateID,Sign,MiRNA) }.
  #minimize{ 1@2,MiRNA: gate_input(GateID,Sign,MiRNA) }.
 \end{verbatim}
\end{frame}

\begin{frame}[fragile]{Weighted Sum}
 \begin{verbatim}
  #minimize{ 1@1,GateID:gate_input(GateID,Sign,MiRNA) }.
  #minimize{ 8@1,MiRNA: gate_input(GateID,Sign,MiRNA) }.
 \end{verbatim}
\end{frame}
\end{document}

 